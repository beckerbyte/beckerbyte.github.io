<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Kontakt – Web3Forms Widget</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs" defer></script>
</head>
<body class="bg-black text-white font-sans">

<!-- Web3Forms Widget Start -->
<div id="web3forms__widget" x-data="{ open: false }">
  <!-- Widget Content -->
  <div
    id="w3f__widget--content"
    x-show="open"
    @click.away="open = false"
    class="fixed flex flex-col z-50 bottom-[100px] top-0 right-0 h-auto left-0 sm:top-auto sm:right-5 sm:left-auto h-[calc(100%-95px)] w-full sm:w-[350px] overflow-auto min-h-[250px] sm:h-[600px] border border-gray-700 bg-zinc-900 shadow-2xl rounded-md"
  >
    <div class="flex p-5 flex-col justify-center items-center h-32 bg-zinc-800">
      <h3 class="text-lg text-white">Wie kann ich helfen?</h3>
      <p class="text-white text-sm opacity-60">Ich antworte in der Regel innerhalb weniger Stunden</p>
    </div>
    <div class="p-6 flex-grow">
      <form id="contactForm" class="space-y-4 needs-validation" novalidate>
        <input type="hidden" name="access_key" value="YOUR_ACCESS_KEY_HERE">
        <input type="hidden" name="subject" value="Neue Nachricht über das Kontakt-Widget">
        <input type="hidden" name="from_name" value="Kontaktformular">

        <!-- Name -->
        <div>
          <label for="name" class="text-sm">Name</label>
          <input type="text" id="name" name="name" required placeholder="Max Mustermann"
            class="w-full mt-1 px-3 py-2 bg-zinc-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-400" />
          <p class="text-sm text-red-400 hidden" id="nameError">Bitte Name eingeben.</p>
        </div>

        <!-- Email -->
        <div>
          <label for="email" class="text-sm">E-Mail</label>
          <input type="email" id="email" name="email" required placeholder="max@beispiel.de"
            class="w-full mt-1 px-3 py-2 bg-zinc-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-400" />
          <p class="text-sm text-red-400 hidden" id="emailError">Bitte gültige E-Mail eingeben.</p>
        </div>

        <!-- Nachricht -->
        <div>
          <label for="message" class="text-sm">Nachricht</label>
          <textarea id="message" name="message" rows="4" required placeholder="Deine Nachricht ..."
            class="w-full mt-1 px-3 py-2 bg-zinc-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-400"></textarea>
          <p class="text-sm text-red-400 hidden" id="messageError">Bitte Nachricht eingeben.</p>
        </div>

        <!-- Datenschutz -->
        <div class="text-sm text-gray-400">
          <label class="inline-flex items-start space-x-2">
            <input type="checkbox" name="privacy" required class="accent-green-500 mt-1">
            <span>Ich akzeptiere die <a href="datenschutz.html" target="_blank" class="underline hover:text-green-400">Datenschutzerklärung</a>.</span>
          </label>
        </div>

        <!-- Cookie Hinweis -->
        <div class="text-xs text-gray-500 italic">
          Durch das Senden stimmst du der Verarbeitung deiner Daten durch Web3Forms zu.
        </div>

        <!-- Submit Button -->
        <div>
          <button type="submit"
            class="w-full px-4 py-2 bg-green-500 hover:bg-green-400 text-black font-semibold rounded-md transition">
            Nachricht senden
          </button>
          <p id="formResult" class="text-center text-sm mt-2"></p>
        </div>
      </form>
    </div>
  </div>

  <!-- Toggle Button -->
  <button
    @click="open = !open"
    class="fixed z-40 right-5 bottom-5 shadow-lg flex justify-center items-center w-14 h-14 bg-green-500 rounded-full hover:bg-green-400 transition"
  >
    <svg x-show="!open" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" />
    </svg>
    <svg x-show="open" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <line x1="6" y1="6" x2="18" y2="18" />
      <line x1="6" y1="18" x2="18" y2="6" />
    </svg>
  </button>
</div>

<!-- Script -->
<script>
document.getElementById('contactForm').addEventListener('submit', async function (e) {
  e.preventDefault();
  const form = e.target;
  const result = document.getElementById('formResult');

  // Validation
  const name = form.name;
  const email = form.email;
  const message = form.message;
  let valid = true;

  document.querySelectorAll('#nameError, #emailError, #messageError').forEach(el => el.classList.add('hidden'));

  if (!name.value.trim()) {
    document.getElementById('nameError').classList.remove('hidden');
    valid = false;
  }
  if (!email.value.trim() || !email.validity.valid) {
    document.getElementById('emailError').classList.remove('hidden');
    valid = false;
  }
  if (!message.value.trim()) {
    document.getElementById('messageError').classList.remove('hidden');
    valid = false;
  }

  if (!valid) return;

  const formData = new FormData(form);
  const response = await fetch("https://api.web3forms.com/submit", {
    method: "POST",
    body: formData
  });

  if (response.ok) {
    result.textContent = "Nachricht erfolgreich gesendet!";
    result.className = "text-green-400";
    form.reset();
  } else {
    result.textContent = "Fehler beim Senden. Bitte später erneut versuchen.";
    result.className = "text-red-400";
  }
});
</script>

</body>
</html>